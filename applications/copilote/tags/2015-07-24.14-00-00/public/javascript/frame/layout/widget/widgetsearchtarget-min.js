YUI.add("widgetsearchtarget",function(b){function a(){a.superclass.constructor.apply(this,arguments)}a.NAME="WidgetSearchTarget";a.ATTRS={sDestination:{value:""},sSource:{value:""}};b.WidgetSearchTarget=b.extend(a,b.WidgetSearch,{initializer:function(){var c=this.get("oWidgetDef");if(!b.Lang.isUndefined(c.options)){if(!b.Lang.isUndefined(c.options.destination)){this.set("sDestination",c.options.destination)}if(!b.Lang.isUndefined(c.options.source)){this.set("sSource",c.options.source)}}},OnSelect:function(k){var p=k.result;var n=arguments[1];var j=b.one(document.getElementById(n.UniqId()));var o=n.get("oSearchDataSet");var f=o.MetaData().AllFields();var d=[];var l="";var m="";k.preventDefault();j.ac.hide();for(var h=0;h<f.length;h++){if(b.Lang.isUndefined(p.raw[f[h]])==false){if(f[h]!="head"&&f[h]!="body"&&f[h]!="footer"&&f[h]!="field_value"){d[f[h]]=p.raw[f[h]]}else{if(f[h]=="field_value"){l=p.raw[f[h]]}else{if(f[h]==n.get("sSource")){m=p.raw[f[h]]}}}}}j.ac.set("value",l);j.set("value",l,false);if(n.get("oTargetDataSet")!=null){var g=n.get("oTargetDataSet");if(n.get("sActionOnTarget")==n.get("MODE_REPLACE")){n.Layout().Frame().DataSetManager().UpdateRecord(g,d)}else{if(n.get("sActionOnTarget")==n.get("MODE_INSERT")){if(!d.length){return}if(n.get("sQuickAddKey")!=null){d[n.get("sQuickAddKey")]=p.raw[n.get("sQuickAddKey")]}n.Layout().Frame().DataSetManager().AddRecord(g,d)}else{throw new b.VznException(null,"WidgetSearch: unknow action after select: "+n.get("sActionOnTarget"),"OnSelect","Y.WidgetSearch")}}}var o=n.get("oSearchDataSet");var c=n.Layout().GetWidget(n.get("sDestination"));if(m==null){c.Field().SetValue(null)}else{c.Field().SetValue(m)}c.Update();n.Layout().Frame().DataSetManager().UpdateRowData(o.Id(),[p.raw])}})},"0.0.1",{requires:["widgetsearch"]});